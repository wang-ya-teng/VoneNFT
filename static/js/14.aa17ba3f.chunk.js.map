{"version":3,"sources":["Assets/metamask-logo.png","Views/Login/index.js"],"names":["Login","useSelector","state","walletAddress","chainId","useState","okText","setOkText","cancelText","setCancelText","content","setContent","title","setTitle","isModalVisible","setIsModalVisible","router","useHistory","useEffect","localStorage","isLogin","push","className","src","metamaskLogo","alt","width","onClick","window","ethereum","isMetaMask","connectWeb3Modal","navigator","userAgent","indexOf","connect","SupportMode","visible","setVisible"],"mappings":"gMAAe,G,QAAA,IAA0B,2C,gDCQ1B,SAASA,IACtB,MAAmCC,aAAY,SAACC,GAAD,OAAWA,KAAlDC,EAAR,EAAQA,cAAeC,EAAvB,EAAuBA,QACvB,EAA4BC,mBAAS,IAArC,mBAAOC,EAAP,KAAeC,EAAf,KACA,EAAoCF,mBAAS,IAA7C,mBAAOG,EAAP,KAAmBC,EAAnB,KACA,EAA8BJ,mBAAS,IAAvC,mBAAOK,EAAP,KAAgBC,EAAhB,KACA,EAA0BN,mBAAS,IAAnC,mBAAOO,EAAP,KAAcC,EAAd,KACA,EAA4CR,oBAAS,GAArD,mBAAOS,EAAP,KAAuBC,EAAvB,KACMC,EAASC,cAEfC,qBAAU,WAELf,GAAegB,aAAaC,SAC7BJ,EAAOK,KAAP,yBAA8BjB,EAA9B,YAAyCD,MAE1C,CAACA,EAAeC,EAASY,IAuB5B,OACE,qCACE,qBAAKM,UAAU,QAAf,SACE,sBAAKA,UAAU,YAAf,UACE,qBAAKA,UAAU,QAAf,sCACA,sBAAKA,UAAU,gBAAf,UACE,qBAAKA,UAAU,eAAf,SACE,qBAAKC,IAAKC,EAAcC,IAAI,GAAGC,MAAM,UAEvC,qBAAKJ,UAAU,YAEjB,qBAAKA,UAAU,YAAYK,QAAS,kBAjC5B,WAAO,IAAD,GAEhB,UAACC,OAAOC,gBAAR,aAAC,EAAiBC,aAgBpBf,GAAkB,GAClBgB,eAhBIC,UAAUC,UAAUC,QAAQ,WAAa,GAAKF,UAAUC,UAAUC,QAAQ,YAAc,GAC1FnB,GAAkB,GAClBR,EAAU,wBACVE,EAAc,gBACdE,EAAW,kXACXE,EAAS,gCAETE,GAAkB,GAClBR,EAAU,gBACVE,EAAc,gBACdE,EAAW,0IACXE,EAAS,iDAmBmCsB,IAA1C,mDAGJ,8BACGrB,EACC,cAACsB,EAAA,EAAD,CAAaC,QAASvB,EAAgBR,OAAQA,EAAQE,WAAYA,EAAYE,QAASA,EAASE,MAAOA,EAAO0B,WAAYvB,IACxH","file":"static/js/14.aa17ba3f.chunk.js","sourcesContent":["export default __webpack_public_path__ + \"static/media/metamask-logo.e5a4cbfc.png\";","import './index.scss'\r\nimport metamaskLogo from 'Assets/metamask-logo.png';\r\nimport { connectWeb3Modal } from 'Connections/web3Modal';\r\nimport { useState, useEffect } from 'react';\r\nimport { useSelector } from 'react-redux';\r\nimport { useHistory } from 'react-router-dom';\r\nimport SupportMode from 'Components/SupportMode';\r\n// 登陆页面\r\nexport default function Login() {\r\n  const { walletAddress, chainId } = useSelector((state) => state);\r\n  const [okText, setOkText] = useState('')\r\n  const [cancelText, setCancelText] = useState('')\r\n  const [content, setContent] = useState('')\r\n  const [title, setTitle] = useState('')\r\n  const [isModalVisible, setIsModalVisible] = useState(false) // 未安装metamask钱包的弹框显示状态\r\n  const router = useHistory()\r\n\r\n  useEffect(() => {\r\n    // 登录状态为true 且能取到钱包地址 跳转到个人中心页面\r\n    if(walletAddress&&localStorage.isLogin) {\r\n      router.push(`/profile/index/${chainId}/${walletAddress}`)\r\n    }\r\n  }, [walletAddress, chainId, router]);\r\n  const connect = () => {\r\n    // 判断浏览器是否安装metamask钱包\r\n    if (!window.ethereum?.isMetaMask) {\r\n      if (navigator.userAgent.indexOf('WebKit') > -1 || navigator.userAgent.indexOf('Firefox') > -1) {\r\n        setIsModalVisible(true)\r\n        setOkText('前往MetaMask')\r\n        setCancelText('返回')\r\n        setContent('您的浏览器未安装MetaMask，是否要前往MetaMask官网下载安装？安装成功后，请返回并刷新登录页面；首次登录时，请按照MetaMask的引导进行账号设置。')\r\n        setTitle('MetaMask未安装')\r\n      } else {\r\n        setIsModalVisible(true)\r\n        setOkText('确定')\r\n        setCancelText('返回')\r\n        setContent('当前浏览器不兼容MetaMask钱包，请使用谷歌Chrome浏览器。')\r\n        setTitle('浏览器不兼容MetaMask')\r\n      }\r\n    } else {\r\n      // \r\n      setIsModalVisible(false)\r\n      connectWeb3Modal();\r\n    }\r\n  };\r\n  return (\r\n    <>\r\n      <div className=\"login\">\r\n        <div className=\"login-box\">\r\n          <div className=\"title\">连接钱包</div>\r\n          <div className=\"metamask-logo\">\r\n            <div className=\"metamask-img\">\r\n              <img src={metamaskLogo} alt=\"\" width=\"400\" />\r\n            </div>\r\n            <div className=\"line\"></div>\r\n          </div>\r\n          <div className=\"login-btn\" onClick={() => connect()}>使用MetaMask登录</div>\r\n        </div>\r\n      </div>\r\n      <div>\r\n        {isModalVisible ? (\r\n          <SupportMode visible={isModalVisible} okText={okText} cancelText={cancelText} content={content} title={title} setVisible={setIsModalVisible}></SupportMode>\r\n        ) : null}\r\n      </div>\r\n    </>\r\n  )\r\n}\r\n"],"sourceRoot":""}